<% content_for :title, "Posts" %>

<div class="max-w-3xl mx-auto space-y-6">
  <!-- Head with title and New Post button -->
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-bold">Posts</h1>

    <% if user_signed_in? %>
      <%= link_to "New Post", new_post_path,
            data: { turbo_frame: "new_post" },
            class: "btn-primary" %>
    <% end %>
  </div>

  <div id="posts_list" class="grid gap-4">
    <!-- Listen to the broadcast -->
    <%= turbo_stream_from "posts" %> 
    <!-- New Post frame -->
    <%= turbo_frame_tag "new_post" %>

    <!-- Posts list -->
    <% @posts.each do |post| %>
      <div id="post_<%= post.id %>_container" class="p-4 border rounded-lg shadow-sm bg-white">
        <%= turbo_frame_tag "post_#{post.id}_content" do %>
          <%= render post %>
        <% end %>
        <%= turbo_frame_tag "post_#{post.id}_actions" do %>
          <%= render "posts/post_actions", post: post %>
        <% end %>
      </div>
    <% end %>

  </div>
</div>
